\documentclass{article}

\usepackage{xcolor} % for different colour comments
\usepackage{graphicx}
\graphicspath{{/home/danny/Pictures/}} %Will need to be compiled on Danny's machine with this line!!!

%% Comments
\newif\ifcomments\commentstrue

\newcommand{\cs}[1]{\authornote{blue}{cs}{#1}} %Connor
\newcommand{\dm}[1]{\authornote{blue}{dm}{#1}} %Danny
\newcommand{\sm}[1]{\authornote{blue}{SM}{#1}} %Shani

\renewcommand*\contentsname{Table of Contents}

\begin{document}

\title{OpenBazaar Redevelopment - Design Document}
\author{The Fair Traders \\ Daniel Mandel - mandeldr \\ Shandelle Murray - murras25 \\ Connor Sheehan - sheehacg}
\date{\today}
\maketitle

\begin{abstract}
This documents outlines design for the OpenBazaar redevelopment project.
\end{abstract}

\newpage

\tableofcontents

\addcontentsline{toc}{section}{Revision History}
\section*{Revision History}

\begin{table}[h!]
\centering
\begin{tabular}{||c c c c||}
 \hline
 Revision Number & Revision Date & Description of Change & Author \\ [0.5ex]
 \hline\hline
 1 & November 4th, 2015 & Created Revision History & Daniel Mandel \\ [1ex]
 \hline
\end{tabular}
\caption{Table to capture the history of the document}
\label{table:1}
\end{table}

\addcontentsline{toc}{section}{Introduction}
\section*{Introduction}
\subsection{Purpose}
The purpose of this document is to describe the implementation of the OpenBazaar that was described in the Software Requirements Specification (SRS) document completed earlier this semester. It aims to outline a design that will meet all of the functional and non-functional requirements described in the SRS. It is also meant to be a template for creating the Module Interface Specification document, MIS, which will describe the modules in further detail. 

The design principle being used to implement this project is the principle of information hiding which was first described by David Parnas (Parnas,1972). The idea behind this design strategy is that each module contains some secret, essentially hiding a design decision from the rest of the system. As a result of this method of modularization, aspects of the system that are likely to change are hidden within a module and, when changed, do not affect the rest of the modules. This is important for any software design as technology is constantly evolving and software often needs to be updated in order to remain relevant.

This document is intended for future developers and designers who wish to improve or better understand the design of the OpenBazaar.

\subsection{Scope}
The purpose of this project is to design and implement OpenBazaar, a free, open market run through a peer-to-peer network that aims to replace centralized services such as eBay or Amazon by providing a means in which to participate in online trade. Major users of the OpenBazaar include buyers, sellers, and notaries. This document describes the implementation details of all major functions that create the OpenBazaar, from every type of user's perspective: buyers, sellers, and notaries.


\addcontentsline{toc}{section}{Anticipated and Unlikely Changes}
\section*{Anticipated and Unlikely Changes}
This section is intended for all possible changes that may occur to the system. They will be listed in order from most likely to least likely.
\newline
\newline
\subsection{Anticipated Changes}
\begin{itemize}
	\item
	The hardware the OpenBazaar runs on
	\item
	The operating system the Openbazaar runs on
	\item
	A user's information such as their: public and private key, role (buyer, seller, notary), IP Address, Bitcoin information, digital signature, GUID, market(items,price,description), and personal settings (i.e. display picture)
	\item
	The algorithm to search for nodes on the network
	\item
	Personalization options for a user market
\end{itemize}

\subsection{Unlikely Changes}
\begin{itemize}
\item
Bitcoin as a medium of exchange

\item
Ricardian contract structure

\item

\end{itemize}

\addcontentsline{toc}{section}{Module Hierarchy}
\section*{Module Hierarchy}
This section outlines the modules used in the implementation of the application. Each module is organized and decomposed according to the type of secret it contains.
\begin{itemize}
\item
Server/Network Module
\item
Connector Module
\item
GUI Module
\item
Node Module
\item
Identity Module
\item
Ricardian Contract Module
\item
DHT/Routing Table Module
\item
Settings Module
\item
Store Module
\item
Notary Module
\item
Bitcoin Module
\end{itemize}



\begin{itemize}
\item
Hardware Hiding Module
\begin{itemize}
\item
GUI Module. This module will contain hardware-independent modules from the PyQt4 library.
\end{itemize}

\item
Behaviour Hiding Module
\begin{itemize}


\item
Node Module
\begin{itemize}
\item
Routing table module
\item
Published contract module
\end{itemize}


\item
Identity Module
\begin{itemize}
\item
Settings Module

\item
Stores Module

\item
Notaries Module

\item
Active Contract Module
\end{itemize} % End id module itemize

\end{itemize} % End Behaviour hiding itemize

\item
Software Decision Module % More related to algorithms, hashing 
\begin{itemize}
\item
Algorithms Module

\item
Initialization Module
\end{itemize} % End Software Decision itemize

\end{itemize} % End Module hierarchy itemize





\addcontentsline{toc}{section}{Connection Between Requirements and Design}
\section*{Connection Between Requirements and Design}

\addcontentsline{toc}{section}{Module Decomposition}
\section*{Module Decomposition}
Below is a decomposition of each module in the application design, with details of the module's provided services and encapsulated secrets.

\subsection{Hardware Hiding Modules}
\begin{enumerate}
\item
GUI Module

\begin{itemize}
\item
\textbf{Secret:} The underlying machine hardware and operating system environment for the application.

\item
\textbf{Services:} The GUI module is responsible for handling user interaction with the system. Provides controllers which take inputted data and relay to the frontend-to-backend connector for further analysis and use.

\item
\textbf{Implemented by:} The module has been partly implemented via the PyQt4 framework. Implementation will be done by creating components which inherit from classes in the PyQt4 module.
\end{itemize}
\end{enumerate}

\subsection{Behaviour Hiding Modules}
\begin{enumerate}
\item
Backend Module
\begin{itemize}
\item
\textbf{Secret:} The underlying data and behaviour requirements of the system.

\item
\textbf{Services:} The backend module is primarily responsible for holding all of the modules relevant to system requirements. It holds user data including all given personalization data, trade contracts and application settings. User interaction will pass through the connector module to this module.
\end{itemize}

\item
Node module
\begin{itemize}
\item
\textbf{Secret:} Information related to the peer-to-peer networking component of the application.

\item
\textbf{Services:} This module provides all data and behaviours that make a machine a valid network node.
\end{itemize}

\item
DHT Module
\begin{itemize}
\item
\textbf{Secret:} The contents and implementation of the distributed hash table and routing talbes for the Kademlia peer-to-peer network.

\item
\textbf{Services:} The DHT module provides information about the distributed hash table used for networking. The module does node lookups and returns information about 
\end{itemize}
\end{enumerate}

\subsection*{Description}
The OpenBazaar modules are broken up into logical components, abstracting away portions of the application that do not depend on one another. The first logical decomposition of the application is to abstract the details of the graphical user interface from the details of the data implementation. Each of these respective components will run as its own thread in the application environment. The data implementation can then be manipulated and accessed by the user via interaction with the GUI. To facilitate this interaction a connector module will be created. This module will expose an interface for the GUI to interact with that submits and returns data for graphical display to the user.

\subsection*{Front-End Client}
\begin{itemize}
\item
BazaarMain

%Sublist in BazaarMain
\begin{itemize}
\item
Inherits from QMainWindow in PyQt4 module

\item
All other GUI components are contained within the QMainWindow

\item
Instance variable menuBar holds the menu bar of the application
\end{itemize}

\item
\end{itemize}


\subsection*{Back-End Server}
\begin{itemize}
\item

\end{itemize}

\subsection*{Server-Client Connection}
\begin{itemize}
\item

\end{itemize}

\addcontentsline{toc}{section}{Traceability Matrix}
\section*{Traceability Matrix}

\addcontentsline{toc}{section}{Use Hierarchy Between Modules}
\section*{Use Hierarchy Between Modules}


\begin{comment}
% EXTREMELY ROUGH MODULE DECOMPOSITION
Modules for GUI 

QMainWindow - RedevBazaar 

Holds everything else in the application 

RedevBazaarConnector 

QVBoxLayout 

Main layout for two windows 

QLabel - Logo 

Holds main logo, top right corner 

Avatar photo - QLabel 

Holds any chosen avatar logo from the user 

QLineEdit - Search bar 

QTabWidget 

Holds the menus for messages, etc 

QButton - Search 

QListWidget - Merchant list 

QLineEdit - Add merchants 

QButton - Add Merchant confirm 

QListWidget - Notary list 

QLineEdit - Add Notary 

QButton - Add notary confirm 

QListWidget - Past contracts 


Modules for Server 
Networking 

The server end of the application has a networking component to enable the decentralization of the application. 

This component includes: 

Unique GUID for network node 

Create a public key between 1 - 2^256, derive private key from that 

Sign own public key with private key 

SHA256 this self-signed key 

RIPEMD160 the SHA256 hash 

Distributed hash table 

Row would be GUID, dynamic IP, port, contract hash, keyword 

Contains list of nodes within similar range. Allows for easy finding of other network nodes 



Ricardian Contracts 
Metadata 

Info about contract creation date, valid period etc 

ID Module 

Contains all user info as given by the user 

Trade module 

Contains information regarding services/goods provided and bitcoin amount received 

Ledger Module 

Contains info created as the contract is signed and processed, to ensure validity

\end{comment}



\end{document}

